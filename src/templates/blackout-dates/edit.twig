{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% set selectedSubnavItem = 'blackout-dates' %}
{% set title = blackoutDate ? 'Edit Blackout Date'|t('booked') : 'New Blackout Date'|t('booked') %}

{% set fullPageForm = true %}

{% block content %}
    <input type="hidden" name="action" value="booked/cp/blackout-dates/save">
    {% if blackoutDate %}
        <input type="hidden" name="elementId" value="{{ blackoutDate.id }}">
    {% endif %}

    <div id="fields">
        {{ forms.textField({
            label: 'Title'|t('app'),
            id: 'title',
            name: 'title',
            value: blackoutDate.title ?? '',
            required: true,
            autofocus: true,
            errors: blackoutDate ? blackoutDate.getErrors('title') : []
        }) }}

        {{ forms.dateField({
            label: 'Start Date'|t('booked'),
            id: 'startDate',
            name: 'startDate',
            value: blackoutDate.startDate ?? '',
            required: true,
            errors: blackoutDate ? blackoutDate.getErrors('startDate') : []
        }) }}

        {{ forms.dateField({
            label: 'End Date'|t('booked'),
            id: 'endDate',
            name: 'endDate',
            value: blackoutDate.endDate ?? '',
            required: true,
            errors: blackoutDate ? blackoutDate.getErrors('endDate') : []
        }) }}

        {{ forms.selectField({
            label: 'Location'|t('booked'),
            id: 'locationId',
            name: 'locationId',
            options: [{ label: 'Global (All Locations)'|t('booked'), value: '' }] | merge(locations|map(l => { label: l.title, value: l.id })),
            value: blackoutDate.locationId ?? '',
            instructions: 'Limit this blackout to a specific location.'|t('booked')
        }) }}

        {{ forms.selectField({
            label: 'Employee'|t('booked'),
            id: 'employeeId',
            name: 'employeeId',
            options: [{ label: 'All Employees'|t('booked'), value: '' }] | merge(employees|map(e => { label: e.title, value: e.id })),
            value: blackoutDate.employeeId ?? '',
            instructions: 'Limit this blackout to a specific employee.'|t('booked')
        }) }}

        {{ forms.lightswitchField({
            label: 'Active'|t('booked'),
            id: 'isActive',
            name: 'isActive',
            on: blackoutDate ? blackoutDate.isActive : true
        }) }}
    </div>
{% endblock %}
