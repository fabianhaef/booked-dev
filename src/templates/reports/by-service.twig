{% extends "_layouts/cp" %}

{% set title = "Service Performance Report" %}

{% block content %}
    <div class="flex justify-between items-center mb-6">
        <h1>Service Performance</h1>
        <a href="{{ url('booked/reports') }}" class="btn">‚Üê Back to Reports</a>
    </div>

    {# Summary #}
    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 24px; margin-bottom: 24px;">
        <div style="font-size: 14px; color: #6b7280; margin-bottom: 8px;">Total Bookings</div>
        <div style="font-size: 36px; font-weight: bold; color: #3b82f6;">{{ totalBookings }}</div>
    </div>

    {# Services Breakdown #}
    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 24px;">
        <h3 style="margin: 0 0 20px 0;">Bookings by Service</h3>

        {% if serviceBookings|length > 0 %}
            {% for serviceId, data in serviceBookings %}
                <div style="padding: 16px; border-bottom: 1px solid #f3f4f6;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div>
                            <div style="font-weight: 600; font-size: 16px;">
                                {{ data.service ? data.service.title : 'Service #' ~ serviceId }}
                            </div>
                            <div style="font-size: 13px; color: #6b7280; margin-top: 4px;">
                                {{ data.percentage|number_format(1) }}% of total bookings
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 28px; font-weight: bold; color: #3b82f6;">{{ data.count }}</div>
                            <div style="font-size: 12px; color: #6b7280;">bookings</div>
                        </div>
                    </div>

                    {# Progress bar #}
                    <div style="background: #e5e7eb; height: 12px; border-radius: 6px; overflow: hidden;">
                        <div style="background: linear-gradient(90deg, #3b82f6 0%, #60a5fa 100%); height: 100%; width: {{ data.percentage }}%; transition: width 0.3s ease;"></div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div style="text-align: center; color: #9ca3af; padding: 60px 0;">
                No service data available
            </div>
        {% endif %}
    </div>
{% endblock %}
